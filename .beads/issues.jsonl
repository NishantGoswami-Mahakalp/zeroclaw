{"id":"zeroclaw-2cw","title":"Epic: Full daemon deployment with Cloudflare-only auth","description":"WHY: Move VPS from gateway-only to full daemon runtime while keeping web UI configuration available and enforcing Cloudflare Access as the only auth boundary. WHAT: Implement daemon-first deployment, remove pairing fallback in runtime auth, align config mount/runtime paths, and validate diagnostics. HOW: Execute phased migration with verifiable rollout checks and doctor/health gates.","acceptance_criteria":"1) VPS runs zeroclaw daemon in production; 2) Web UI config endpoints remain functional during daemon runtime; 3) Cloudflare Access is sole auth path when enabled; 4) /api/doctor reports zero errors in daemon mode; 5) Rollback path documented and tested.","status":"open","priority":1,"issue_type":"epic","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:58:15.880036866+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T07:58:15.880036866+05:30"}
{"id":"zeroclaw-2cw.1","title":"Task: Runtime auth hard cutover to Cloudflare Access","description":"WHY: Internal deployment requires no fallback auth paths and pairing must not be active in runtime auth flow. WHAT: Enforce Cloudflare JWT-only checks across API/SSE/WS/webhook paths, remove /pair route exposure, and clean gateway status messaging. HOW: Refactor gateway auth guards, route table, and related response payloads/tests to eliminate pairing runtime dependence.","acceptance_criteria":"1) API/SSE/WS/webhook reject non-Cloudflare-authenticated requests when cf_access_enabled=true; 2) /pair is not routed; 3) No runtime fallback to bearer pairing token remains; 4) cargo check passes.","status":"closed","priority":1,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:58:27.343120644+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T08:11:21.171694647+05:30","closed_at":"2026-02-26T08:11:21.171697462+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.1","depends_on_id":"zeroclaw-2cw","type":"parent-child","created_at":"2026-02-26T07:58:27.344139848+05:30","created_by":"Nishant Goswami"}]}
{"id":"zeroclaw-2cw.1.1","title":"Subtask: Remove pairing routes and gateway pairing UX","description":"Delete /pair route binding and remove pairing-specific startup/log messages and health payload fields that imply token pairing flow.","acceptance_criteria":"1) /pair route removed from router; 2) gateway startup output references Cloudflare auth state only; 3) health/status payloads no longer expose pairing-only fields.","status":"closed","priority":1,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:58:37.734871799+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T08:10:51.271242456+05:30","closed_at":"2026-02-26T08:10:51.271246493+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.1.1","depends_on_id":"zeroclaw-2cw.1","type":"parent-child","created_at":"2026-02-26T07:58:37.735617309+05:30","created_by":"Nishant Goswami"}]}
{"id":"zeroclaw-2cw.1.2","title":"Subtask: Enforce Cloudflare JWT-only auth guards","description":"Update API, SSE, WS, and webhook auth checks to require valid Cloudflare Access JWT when cf_access_enabled=true, with no bearer token fallback.","acceptance_criteria":"1) Auth middleware/guards check Cf-Access-Jwt-Assertion or CF_Authorization path only; 2) invalid/missing JWT returns 401; 3) no bearer fallback branch exists in these handlers.","status":"closed","priority":1,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:58:52.606928667+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T08:11:15.645348328+05:30","closed_at":"2026-02-26T08:11:15.645352185+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.1.2","depends_on_id":"zeroclaw-2cw.1","type":"parent-child","created_at":"2026-02-26T07:58:52.607883631+05:30","created_by":"Nishant Goswami"}]}
{"id":"zeroclaw-2cw.2","title":"Task: Switch VPS runtime to daemon mode","description":"WHY: Production should run full supervised runtime instead of gateway-only process. WHAT: Update deployment command and container startup behavior to run  with current host/port settings. HOW: Change workflow run command, preserve rollback path, verify daemon components start.","acceptance_criteria":"1) deploy workflow starts container with daemon command; 2) logs show daemon supervisor start; 3) gateway remains reachable through Caddy; 4) rollback command documented.","status":"closed","priority":1,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:59:06.873275822+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T08:20:55.437576851+05:30","closed_at":"2026-02-26T08:20:55.437581129+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.2","depends_on_id":"zeroclaw-2cw","type":"parent-child","created_at":"2026-02-26T07:59:06.874266623+05:30","created_by":"Nishant Goswami"}]}
{"id":"zeroclaw-2cw.2.1","title":"Subtask: Update deploy workflow to run daemon","description":"Modify .github/workflows/deploy-vps.yml docker run invocation to execute daemon mode explicitly and preserve env needed for bind/network.","acceptance_criteria":"1) workflow uses daemon command; 2) deployment run succeeds; 3) container starts without crash loops.","status":"closed","priority":1,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:59:06.900339816+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T08:13:26.325760021+05:30","closed_at":"2026-02-26T08:13:26.325763527+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.2.1","depends_on_id":"zeroclaw-2cw.2","type":"parent-child","created_at":"2026-02-26T07:59:06.901161069+05:30","created_by":"Nishant Goswami"}]}
{"id":"zeroclaw-2cw.2.2","title":"Subtask: Verify daemon component startup in logs","description":"Capture and validate startup logs for gateway/channels/heartbeat/scheduler supervisor behavior after daemon switch.","acceptance_criteria":"1) logs include daemon start line; 2) expected component status lines present; 3) no fatal startup errors.","status":"open","priority":2,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:59:06.9287129+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T07:59:06.9287129+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.2.2","depends_on_id":"zeroclaw-2cw.2","type":"parent-child","created_at":"2026-02-26T07:59:06.929696056+05:30","created_by":"Nishant Goswami"}]}
{"id":"zeroclaw-2cw.3","title":"Task: Align runtime config paths for daemon and web UI","description":"WHY: Current deployment mount path and runtime read path can diverge, causing stale config behavior. WHAT: Align container mounts and config/workspace paths so daemon, gateway, and UI all read/write the same config file. HOW: Update deployment mounts and verify live writes from /api/config persist to active path.","acceptance_criteria":"1) runtime reads mounted config path; 2) UI PUT /api/config writes same file used by daemon; 3) daemon_state.json written in expected mounted directory.","status":"closed","priority":1,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:59:22.327346226+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T08:21:00.147371531+05:30","closed_at":"2026-02-26T08:21:00.147375278+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.3","depends_on_id":"zeroclaw-2cw","type":"parent-child","created_at":"2026-02-26T07:59:22.328510382+05:30","created_by":"Nishant Goswami"}]}
{"id":"zeroclaw-2cw.3.1","title":"Subtask: Fix container mount path to active config directory","description":"Update deployment bind mounts to match nonroot runtime config location used by process.","acceptance_criteria":"1) docker inspect shows expected host-\u003econtainer mapping; 2) startup log config path matches mounted location.","status":"closed","priority":1,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:59:22.358702863+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T08:14:56.935807715+05:30","closed_at":"2026-02-26T08:14:56.935812173+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.3.1","depends_on_id":"zeroclaw-2cw.3","type":"parent-child","created_at":"2026-02-26T07:59:22.35969176+05:30","created_by":"Nishant Goswami"}]}
{"id":"zeroclaw-2cw.3.2","title":"Subtask: Validate live web UI config updates under daemon","description":"Confirm configuration changes made via web UI API are persisted and reflected without breaking daemon runtime.","acceptance_criteria":"1) PUT /api/config returns ok; 2) saved file changes on VPS; 3) daemon continues healthy after update.","status":"open","priority":2,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:59:22.389508044+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T07:59:22.389508044+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.3.2","depends_on_id":"zeroclaw-2cw.3","type":"parent-child","created_at":"2026-02-26T07:59:22.390280054+05:30","created_by":"Nishant Goswami"}]}
{"id":"zeroclaw-2cw.4","title":"Task: Bring diagnostics in line with daemon-first deployment","description":"WHY: Doctor output should reflect daemon runtime expectations in production. WHAT: Ensure daemon state checks, health endpoints, and component statuses report correctly in daemon mode without false errors. HOW: Adjust doctor rules/messages and validate with live daemon deployment.","acceptance_criteria":"1) POST /api/doctor reports zero errors in daemon mode; 2) daemon state freshness shown as ok when running; 3) no misleading gateway-only error classification.","status":"closed","priority":2,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:59:34.103462963+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T08:21:04.753762829+05:30","closed_at":"2026-02-26T08:21:04.753767007+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.4","depends_on_id":"zeroclaw-2cw","type":"parent-child","created_at":"2026-02-26T07:59:34.10457419+05:30","created_by":"Nishant Goswami"}]}
{"id":"zeroclaw-2cw.4.1","title":"Subtask: Normalize daemon state check severity and messaging","description":"Refine daemon state diagnostics to classify missing/stale/running states accurately for daemon deployments.","acceptance_criteria":"1) running daemon =\u003e ok; 2) stale daemon =\u003e warning/error with clear message; 3) tests/checks pass.","status":"closed","priority":2,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:59:34.13059239+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T08:14:10.555098372+05:30","closed_at":"2026-02-26T08:14:10.555102019+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.4.1","depends_on_id":"zeroclaw-2cw.4","type":"parent-child","created_at":"2026-02-26T07:59:34.1313376+05:30","created_by":"Nishant Goswami"}]}
{"id":"zeroclaw-2cw.4.2","title":"Subtask: Add deployment verification checklist for doctor and health","description":"Document and execute post-deploy checks for /health and /api/doctor to prevent regressions.","acceptance_criteria":"1) checklist exists in task notes; 2) latest deploy verified against checklist.","status":"open","priority":3,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:59:34.157485413+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T07:59:34.157485413+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.4.2","depends_on_id":"zeroclaw-2cw.4","type":"parent-child","created_at":"2026-02-26T07:59:34.158486193+05:30","created_by":"Nishant Goswami"}]}
{"id":"zeroclaw-2cw.5","title":"Task: Remove residual pairing surface from config and UX","description":"WHY: Internal policy requires Cloudflare-only auth and no pairing UX/config confusion. WHAT: Remove remaining pairing fields/messages from config schema, onboarding text, and gateway/API payloads where still exposed. HOW: Refactor schema and user-facing strings; keep only Cloudflare auth toggles and key/cert settings.","acceptance_criteria":"1) gateway config schema no longer advertises pairing fields; 2) onboarding/status text references Cloudflare auth only; 3) compile/test passes after cleanup.","status":"closed","priority":2,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:59:46.506540862+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T08:20:51.066238653+05:30","closed_at":"2026-02-26T08:20:51.06624218+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.5","depends_on_id":"zeroclaw-2cw","type":"parent-child","created_at":"2026-02-26T07:59:46.507547913+05:30","created_by":"Nishant Goswami"}]}
{"id":"zeroclaw-2cw.5.1","title":"Subtask: Clean gateway config schema of pairing fields","description":"Delete require_pairing/paired_tokens/pair-rate settings from GatewayConfig and dependent code/tests.","acceptance_criteria":"1) schema and defaults compile without pairing fields; 2) serialization tests updated.","status":"closed","priority":2,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:59:46.536030101+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T08:20:43.149270859+05:30","closed_at":"2026-02-26T08:20:43.149274797+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.5.1","depends_on_id":"zeroclaw-2cw.5","type":"parent-child","created_at":"2026-02-26T07:59:46.536787484+05:30","created_by":"Nishant Goswami"}]}
{"id":"zeroclaw-2cw.5.2","title":"Subtask: Remove pairing references from UI-facing responses","description":"Eliminate paired/pairing status keys and messages from health/status responses and startup banners.","acceptance_criteria":"1) no pairing terms in gateway startup output; 2) /api/status and /health payloads omit pairing keys.","status":"open","priority":3,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:59:46.56214359+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T07:59:46.56214359+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.5.2","depends_on_id":"zeroclaw-2cw.5","type":"parent-child","created_at":"2026-02-26T07:59:46.562874874+05:30","created_by":"Nishant Goswami"}]}
{"id":"zeroclaw-2cw.6","title":"Task: Execute production rollout and verification","description":"WHY: Migration requires controlled rollout with explicit evidence of correctness. WHAT: Deploy daemon-mode build from main, verify Cloudflare-authenticated UI/API behavior, and capture rollback instructions. HOW: Run workflow, validate VPS and edge paths, and record run IDs with outcomes.","acceptance_criteria":"1) production run ID recorded; 2) frontend assets and API reachable through Caddy/Cloudflare; 3) Cloudflare-authenticated requests succeed; 4) rollback steps validated.","status":"open","priority":1,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:59:57.692820429+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T07:59:57.692820429+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.6","depends_on_id":"zeroclaw-2cw","type":"parent-child","created_at":"2026-02-26T07:59:57.693584674+05:30","created_by":"Nishant Goswami"}]}
{"id":"zeroclaw-2cw.6.1","title":"Subtask: Verify Cloudflare-authenticated API path end-to-end","description":"Validate that requests after Cloudflare Access login are accepted while unauthenticated requests are denied.","acceptance_criteria":"1) unauthenticated call denied; 2) authenticated browser session works for UI and /api endpoints.","status":"open","priority":1,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:59:57.721090268+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T07:59:57.721090268+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.6.1","depends_on_id":"zeroclaw-2cw.6","type":"parent-child","created_at":"2026-02-26T07:59:57.722090997+05:30","created_by":"Nishant Goswami"}]}
{"id":"zeroclaw-2cw.6.2","title":"Subtask: Capture rollback procedure and last-known-good image","description":"Document one-command rollback and pin last-known-good image/tag for emergency recovery.","acceptance_criteria":"1) rollback command tested or dry-run validated; 2) known-good image/tag recorded in bead notes.","status":"open","priority":2,"issue_type":"task","owner":"nishaant.goswami@gmail.com","created_at":"2026-02-26T07:59:57.747256947+05:30","created_by":"Nishant Goswami","updated_at":"2026-02-26T07:59:57.747256947+05:30","dependencies":[{"issue_id":"zeroclaw-2cw.6.2","depends_on_id":"zeroclaw-2cw.6","type":"parent-child","created_at":"2026-02-26T07:59:57.748172787+05:30","created_by":"Nishant Goswami"}]}
